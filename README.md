# Reproducing the prospective evaluation of next-day M<sub>w</sub> 3.95+ earthquake forecasting models for California.
This repository provides open-source code, documentation, and other resources necessary to easily and transparently replicate the figures, calculations, and results discussed in Bayona et al. (2025, in review), which describes the prospective evaluation of 51,625 next-day M<sub>w</sub> 3.95+ earthquake forecasts, generated by 27 time-varying statistical models, for California. The development and automation of these models is one of CSEP's (Collaborative for the Study of Earthquake Predictability) major community accomplishments, and their prospective test results mark a milestone in earthquake predictibility research, particularly around their use for operational earthquake forecasting.

## Code description
Documented Python code to run this decade-long forecast experiment can be found in the `code` directory of this repository. This folder contains the `reproducibility_next_day_california.py` file, which performs the calculations and creates the figures presented in the above-mentioned manuscript. The `run_all.sh` file, allocated in the top-level directory, is a shell script that executes the code by only typing `bash ./run_all.sh`.

## Software dependencies

python: 3.12.9

numpy: 1.26.4

pycsep: 0.7.0

cartopy: 0.24.0

To run this reproducibility software package, I reccomend that users first install a pyCSEP environment on their machines ('nc-ndc' in this example; see below). The easiest way to install pyCSEP is via `conda`, although it can also be installed using `pip` or by building it directly from source (see the [Documentation on how to install pyCSEP](https://docs.cseptesting.org/getting_started/installing.html)).

```
conda create -n nc-ndc
conda activate nc-ndc
conda config --set channel_priority flexible
conda install --channel conda-forge numpy=1.26.4 pycsep=0.7.0
```

Users must have approximately 2 GB of available space in disk, as well as access to a Unix shell with python3 and the `requests` library included. If this is not the case, they can install this library using:

```
conda install requests
```

## Forecast database
Forecast files, in HDF5 format, are freely available under the open access Creative license on [Zenodo](https://zenodo.org/records/15076187) and via the [CSEP website](https://cseptesting.org/grid-based-forecasts/). However, given the large size of this database (over 65TB), I provide preprocessed input files, which can be found in the `preprocessed_inputs` folder.

Shall the user wishes to download the forecast database from Zenodo, they can do so via:

```
pip3 install zenodo_get
zenodo_get 15076187
```

## Running instructions
Once the user is "within" the `nc-ncd` environment, with python3 and the `request` library alredy installed, they can run the experiment by simply typing:

```
git clone https://github.com/bayonato89/reproducibility_next_day_california.git
bash ./run_all.sh
```
On a modern desktop computer, running this code could take up to one hour.
